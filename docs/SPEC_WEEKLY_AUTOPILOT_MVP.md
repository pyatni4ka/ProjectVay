# SPEC_WEEKLY_AUTOPILOT_MVP

## A) Scope

### Что MVP делает

- Генерирует план на 7 дней по кнопке.
- Дает замену блюда в 1 тап (3–7 вариантов).
- Дает повтор блюда на завтра или на N дней для meal-prep.
- Строит список покупок с количествами и оценкой бюджета.
- Учитывает домашний инвентарь и приоритет expiring soon.
- Поддерживает событие «я съел другое / поел вне дома / был чит» и перестраивает остаток плана.
- Показывает объяснение «Почему?» по каждому предложению/замене (expandable блок).

### Что MVP не делает

- Полная персонализация уровня медицинской терапии.
- Автономная запись всех нутриентов обратно в Apple Health.
- Идеальная точность для всех неизвестных единиц/ингредиентов (используется graceful fallback).

## B) User Stories

- Как пользователь, я нажимаю «Сгенерировать неделю» и сразу вижу 7 дней с блюдами и бюджетом.
- Как пользователь, я заменяю один прием пищи в 1 тап и приложение пересчитывает план, покупки и бюджет.
- Как пользователь, я могу повторить блюдо на несколько дней, чтобы готовить реже.
- Как пользователь, я вижу список покупок с количествами и примерной стоимостью.
- Как пользователь, я хочу, чтобы приложение учитывало то, что уже есть дома, и сначала использовало продукты с коротким сроком.
- Как пользователь, если я съел не по плану, приложение мягко адаптирует оставшийся день/неделю.
- Как пользователь, я могу открыть «Почему?» и понять, почему мне предложили конкретный вариант.

## C) Screens / UI components

- Week list screen: список 7 дней, статус по калориям и бюджету, кнопка regenerate.
- Day detail screen: список приемов пищи, действия Replace / Repeat / Why?.
- Meal detail screen: детали блюда, макросы, стоимость, время, ингредиенты.
- Replace sheet: 3–7 замен с сортировками и тегами причин.
- Shopping list screen: категории, количества, стоимость, чекбокс «уже есть».
- Quick screen “Cook now”: 3–7 блюд из текущего инвентаря с учетом срока и времени.
- Preferences / constraints screen: dislikes/favorites, аллергии, диеты, сложность.
- Budget screen: day/week/month бюджет, strict/soft, кнопка «Сделать дешевле».

## D) Data & settings

- Пищевые ограничения: allergies, diet type, dislikes/favorites.
- Расписание питания: число приемов пищи (2..6), optional snacks.
- Бюджет: day/week/month + strictness.
- Effort level: quick / standard / complex.
- Источники метрик: Apple Health (вес, body fat %, по возможности consumption).

## E) Acceptance criteria

- При нажатии Generate создается план на 7 дней не дольше целевого SLA (например, до 5 сек на типичном пуле).
- По умолчанию 3 приема пищи; смена на 2..6 меняет per-meal targets и план.
- Replace показывает 3–7 вариантов и применяет замену без ручного пересчета пользователя.
- Repeat на N дней обновляет shopping quantities и бюджет.
- Событие deviation перестраивает только оставшуюся часть дня/недели, прошлые дни не трогаются.
- Shopping list содержит количество + единицу, либо `approximate=true` если точное преобразование неизвестно.
- В strict бюджете превышение запрещено; в soft допускается до 5%.
- В каждом действии есть «Почему?» с 2–3 короткими причинами.

## F) Out of scope

- Персональный коучинг с чат-диалогом.
- Клинические назначения/диагнозы.
- Интеграции с доставками/маркетплейсами.
- Полная автоматическая финансовая аналитика по чекам за месяцы.
