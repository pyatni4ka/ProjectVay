# Тест-план

## 1) iOS

### Unit
- Модель данных: создание/обновление Product/Batch/Settings.
- NotificationScheduler:
  - планирование 5/3/1;
  - перенос из quiet hours в разрешённый интервал;
  - отмена при удалении партии.
- TDEE + дефицит + ограничение шага корректировки калорий.

### Integration
- ScannerService + InventoryService:
  - EAN-13 найден локально;
  - EAN-13 найден online и закэширован;
  - DataMatrix извлёк GTIN и AI(17);
  - fallback на ручное создание.
- RecipeServiceClient:
  - search/recommend/fetch parsing JSON.

### UI
- Онбординг (разрешения, цели, quiet hours, бюджет).
- Главный экран рекомендаций и фильтры.
- Карточка рецепта: источник/видео/ингредиенты/шаги.
- Инвентарь: группировка продукта и партий.

## 2) Backend

### Unit
- Нормализация ингредиентов.
- Формула ранжирования и breakdown.
- Валидация входных payload.

### API
- `/recipes/search` возвращает только рецепты с image.
- `/recipes/recommend` учитывает exclude и avoidBones.
- `/recipes/fetch` кэширует результат и не парсит URL повторно.

### Non-functional
- Ограничение rate limit на IP.
- Таймауты внешнего парсинга.
- Нагрузка: 100 RPS чтения из кэша.

## 3) Acceptance checklist

- Скан EAN-13 добавляет товар максимум за 2-3 действия.
- Неизвестный товар после ручного создания определяется повторно.
- Уведомления 5/3/1 не приходят в quiet hours.
- Рецепты содержат картинку + источник + шаги.
- План питания строится на 1 день и неделю (3 приёма в день).
- Прогресс веса виден из HealthKit (если разрешение выдано).
